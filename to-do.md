# Netcatty Feature TODO List

项目地址: https://github.com/binaricat/Netcatty

## 功能需求清单

### 1. GB18030编码支持 🔤
**优先级**: 高

**需求描述**:
- 支持操作文件名为GB18030编码的文件
- 实现动态编码切换，无需断开重连即可生效
- 解决目前市面上工具需要重新连接才能应用编码设置的问题

**技术要点**:
- SFTP文件列表的编码转换
- 文件名编码自动检测/手动切换
- 保持连接状态下的编码切换

---

### 2. SFTP的sudo提权支持 🔐 (已完成)
- [x] 实现sudo提权功能
  - [x] 研究HexHub的实现原理
  - [x] 实现密码的安全存储与自动填写
  - [x] 完成sudo命令的SFTP封装
  - [x] 优化权限提升的交互流程
- [x] 验证功能稳定性

---

### 3. trzsz协议支持 📁
**优先级**: 中

**需求描述**:
- 集成trzsz文件传输协议
- 参考项目: https://github.com/trzsz/trzsz
- 解决electerm和tabby现有实现中的稳定性问题

**已知问题**:
- electerm和tabby支持trzsz但偶尔无法正常收发文件
- 具体bug现象待补充

**技术要点**:
- trzsz协议完整实现
- 文件传输的错误处理和重试机制
- 传输进度显示
- 大文件传输稳定性测试

---

### 4. 终端性能优化 ⚡
**优先级**: 高

**需求描述**:
- 解决基于xtermjs的终端在大量滚屏时的性能问题
- 确保高速输出场景下键盘输入的实时响应

**核心问题**:
- 大量刷屏时`Ctrl+C`信号发不出去
- tmux切换窗口命令无响应
- 输入延迟严重

**技术要点**:
- 终端渲染性能优化
- 输入处理与渲染分离
- 虚拟滚动/缓冲区管理
- 输入队列优先级处理
- 压力测试场景设计

---

### 5. X11 Forwarding支持 🖥️
**优先级**: 中

**需求描述**:
- 支持X11图形界面转发
- 能够在SSH连接中运行远程图形应用程序

**技术要点**:
- X11转发的SSH配置
- 本地X Server集成或推荐
- 跨平台兼容性（Windows/macOS/Linux）
- 连接配置UI

---

### 6. Terminal到SFTP目录定位 🎯
**优先级**: 中

**需求描述**:
- 在Terminal界面时，点击右上角按钮
- 自动切换到SFTP视图并定位到当前工作目录
- 实现Terminal和SFTP之间的上下文联动

**已知问题**:
- 之前尝试实现但未成功

**技术要点**:
- 获取当前shell的工作目录（`pwd`命令）
- Terminal和SFTP视图的状态同步
- 异步目录切换的UI反馈
- 处理特殊路径（软链接、权限不足等）

**实现思路**:
1. 通过发送`pwd`命令获取当前目录
2. 解析命令输出结果
3. 触发SFTP视图切换
4. 异步加载目标目录内容

---

## 开发注意事项 ⚠️

### 质量要求
- 充分的单元测试和集成测试
- 避免"按下葫芦起了瓢"的问题
- 每个功能都要有完整的测试用例

### 性能考虑
- 避免频繁的AI token消耗
- 代码review和人工测试相结合
- 建立性能基准测试

### 用户体验
- 这些都是"可以没有但有了方便很多"的功能
- 注重细节和边界情况处理
- 提供清晰的错误提示和操作引导

---

## 实现优先级建议

### Phase 1 - 核心功能完善
- [ ] GB18030编码支持
- [ ] 终端性能优化
- [ ] Terminal到SFTP目录定位

### Phase 2 - 高级特性
- [ ] SFTP的sudo提权支持
- [ ] trzsz协议支持

### Phase 3 - 扩展功能
- [ ] X11 Forwarding支持

---

## 参考资料
- trzsz项目: https://github.com/trzsz/trzsz
- 竞品分析: WinSCP, HexHub, electerm, tabby
- 技术栈: xtermjs (需要性能优化方案)

---

**最后更新**: 2026-01-09